<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Defuss Transition Demo</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .demo-container {
            border: 2px solid #ddd;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            background: #f9f9f9;
            min-height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .content-box {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            font-size: 18px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .controls {
            margin: 20px 0;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        button {
            padding: 10px 15px;
            border: none;
            border-radius: 5px;
            background: #667eea;
            color: white;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.2s;
        }
        
        button:hover {
            background: #5a67d8;
        }
        
        .transition-type {
            margin-right: 20px;
            font-weight: bold;
        }
        
        h1 {
            text-align: center;
            color: #333;
        }
        
        .description {
            background: #e8f4fd;
            border-left: 4px solid #667eea;
            padding: 15px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <h1>Defuss Transition Effects Demo</h1>
    
    <div class="description">
        <p><strong>This demo showcases the new transition effects system in defuss.</strong></p>
        <p>Click any button below to see different transition types applied to DOM updates. The transitions are applied to parent elements while preserving defuss's intelligent partial DOM update system.</p>
    </div>

    <div class="controls">
        <span class="transition-type">Fade:</span>
        <button onclick="updateWithTransition('fade', 'Content updated with fade transition!', '#4CAF50')">Fade</button>
        
        <span class="transition-type">Slide:</span>
        <button onclick="updateWithTransition('slide-left', 'Sliding in from right!', '#FF9800')">Slide Left</button>
        <button onclick="updateWithTransition('slide-right', 'Sliding in from left!', '#FF5722')">Slide Right</button>
        <button onclick="updateWithTransition('slide-up', 'Sliding in from bottom!', '#9C27B0')">Slide Up</button>
        <button onclick="updateWithTransition('slide-down', 'Sliding in from top!', '#2196F3')">Slide Down</button>
        
        <span class="transition-type">Scale:</span>
        <button onclick="updateWithTransition('scale', 'Scaling in with style!', '#E91E63')">Scale</button>
        
        <span class="transition-type">Custom:</span>
        <button onclick="customTransition()">Custom Transition</button>
        
        <span class="transition-type">Control:</span>
        <button onclick="updateWithoutTransition()">No Transition</button>
    </div>

    <div class="demo-container">
        <div class="content-box" id="demo-content">
            <div>Ready for transitions!</div>
            <div style="font-size: 14px; margin-top: 10px; opacity: 0.8;">
                Click any button above to see transition effects
            </div>
        </div>
    </div>

    <script type="module">
        import { $ } from '/packages/defuss/src/index.js';

        // Counter to make content changes visible
        let updateCounter = 0;

        // Store functions globally for onclick handlers
        window.updateWithTransition = async function(transitionType, message, color) {
            updateCounter++;
            
            const newContent = `
                <div style="background: ${color}; color: white; padding: 20px; border-radius: 8px; text-align: center;">
                    <div style="font-size: 18px; margin-bottom: 10px;">
                        ${message}
                    </div>
                    <div style="font-size: 14px; opacity: 0.8;">
                        Update #${updateCounter} • Transition: ${transitionType}
                    </div>
                </div>
            `;

            try {
                const $content = await $('#demo-content');
                await $content.update(newContent, {
                    type: transitionType,
                    duration: 500,
                    easing: 'ease-in-out'
                });
                console.log(`Successfully applied ${transitionType} transition`);
            } catch (error) {
                console.error('Transition failed:', error);
            }
        };

        window.customTransition = async function() {
            updateCounter++;
            
            const newContent = `
                <div style="background: linear-gradient(45deg, #ff6b6b, #feca57); color: white; padding: 20px; border-radius: 8px; text-align: center;">
                    <div style="font-size: 18px; margin-bottom: 10px;">
                        Custom transition with rotation!
                    </div>
                    <div style="font-size: 14px; opacity: 0.8;">
                        Update #${updateCounter} • Custom CSS transitions
                    </div>
                </div>
            `;

            try {
                const $content = await $('#demo-content');
                await $content.update(newContent, {
                    styles: {
                        enter: { 
                            opacity: '0', 
                            transform: 'scale(0) rotate(-180deg)',
                            transition: 'all 600ms cubic-bezier(0.68, -0.55, 0.265, 1.55)'
                        },
                        enterActive: { 
                            opacity: '1', 
                            transform: 'scale(1) rotate(0deg)' 
                        },
                        exit: { 
                            opacity: '1', 
                            transform: 'scale(1) rotate(0deg)',
                            transition: 'all 300ms ease-out'
                        },
                        exitActive: { 
                            opacity: '0', 
                            transform: 'scale(0.8) rotate(180deg)' 
                        }
                    },
                    duration: 600
                });
                console.log('Successfully applied custom transition');
            } catch (error) {
                console.error('Custom transition failed:', error);
            }
        };

        window.updateWithoutTransition = async function() {
            updateCounter++;
            
            const newContent = `
                <div style="background: #6c757d; color: white; padding: 20px; border-radius: 8px; text-align: center;">
                    <div style="font-size: 18px; margin-bottom: 10px;">
                        Updated without transition
                    </div>
                    <div style="font-size: 14px; opacity: 0.8;">
                        Update #${updateCounter} • No transition applied
                    </div>
                </div>
            `;

            try {
                const $content = await $('#demo-content');
                await $content.update(newContent); // No transition config
                console.log('Successfully updated without transition');
            } catch (error) {
                console.error('Update failed:', error);
            }
        };

        // Initialize demo
        console.log('Defuss Transition Demo loaded!');
        console.log('Available transition types: fade, slide-left, slide-right, slide-up, slide-down, scale, custom');
    </script>
</body>
</html>
